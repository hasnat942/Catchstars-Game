<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self'">
  <title>Catchstar - Earn Rewards</title>

  <!-- Firebase App (the core Firebase SDK) -->
  <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-analytics.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-firestore.js"></script>
  
  <link rel="stylesheet" href="style.css">
  <script src="script.js" defer></script>

  <style>
    /* Block non-mobile devices */
    @media screen and (min-width: 768px) {
      body {
        display: none;
        visibility: hidden;
      }
    }
  </style>
</head>
<body>
  <header>
    <div class="header-content">
      <h1>Catchstar - Earn Stars & Coins</h1>
      <p>Your journey to becoming a star collector begins here. Invite friends, complete tasks, and earn rewards!</p>
    </div>
  </header>

  <main>
    <section class="welcome-section">
      <div class="welcome-text">
        <h2>Welcome to Catchstar</h2>
        <p>Catchstar allows you to earn coins and stars by completing simple tasks, inviting friends, and staying active daily. Collect coins and redeem them for exciting rewards. The more you invite, the more you earn!</p>
      </div>
      <div class="daily-check-in">
        <h3>Daily Check-in</h3>
        <button id="checkInBtn">Check-in for Today</button>
        <p id="checkInMessage"></p>
      </div>
      <!-- Total Coins Display -->
      <p>Total Coins: <span id="totalCoins">0</span></p>
    </section>

    <!-- Rewards Section -->
    <section class="rewards-section">
      <div class="section-header">
        <h2>Earn More Stars & Coins</h2>
        <p>Invite friends, complete social tasks, and unlock special rewards by growing your Catchstar network!</p>
      </div>

      <div class="rewards-content">
        <!-- Referral Section -->
        <div class="referral-container">
          <h3>Referral Program</h3>
          <p>Invite your friends to Catchstar and earn big rewards based on how many friends join using your referral link!</p>

          <div class="invite-status">
            <p>Friends Referred: <span id="invitesCount">0</span></p>
            <button id="copyReferralLink">Copy Referral Link</button>
            <p id="referralLinkText">Your referral link: <span id="referralLink"></span></p>
          </div>

          <div class="reward-container">
            <div class="reward">
              <p>Refer 3 Friends</p>
              <button class="reward-btn" id="reward3">+25,000 Coins</button>
            </div>
            <div class="reward">
              <p>Refer 5 Friends</p>
              <button class="reward-btn" id="reward5">+50,000 Coins</button>
            </div>
            <div class="reward">
              <p>Refer 10 Friends</p>
              <button class="reward-btn" id="reward10">+100,000 Coins</button>
            </div>
            <div class="reward">
              <p>Refer 100 Friends</p>
              <button class="reward-btn" id="reward100">+1,000,000 Coins</button>
            </div>
          </div>
        </div>

        <!-- Social Tasks -->
        <div class="social-tasks">
          <h3>Social Tasks</h3>
          <p>Complete social media tasks to earn stars and coins. Make sure you're connected to all of our channels!</p>

          <div class="task-item">
            <p>Follow us on Twitter</p>
            <button id="twitterTask">+125 Stars</button>
          </div>
          <div class="task-item">
            <p>Subscribe to our YouTube channel</p>
            <button id="youtubeTask">+125 Stars</button>
          </div>
          <div class="task-item">
            <p>Join our Telegram group</p>
            <button id="telegramTask">+125 Stars</button>
          </div>
        </div>
      </div>
    </section>

    <section class="leaderboard-section">
      <h2>Leaderboard</h2>
      <p>See how you rank against other players. The more stars you collect, the higher your ranking!</p>
      <button onclick="window.location.href='leaderboard.html'">View Leaderboard</button>
    </section>

    <section class="wallet-section">
      <h2>Connect Your Wallet</h2>
      <p>Connect your wallet to Catchstar and securely store the coins you've earned. Withdraw or exchange them anytime!</p>
      <button onclick="window.location.href='wallet.html'">Connect Wallet</button>
    </section>
  </main>

  <footer>
    <div class="footer-nav">
      <button onclick="window.location.href='home.html'">Home</button>
      <button onclick="window.location.href='profile.html'">Profile</button>
      <button onclick="window.location.href='help.html'">Help & FAQ</button>
    </div>
    <p>&copy; 2024 Catchstar. All rights reserved.</p>
  </footer>

  <script>
    // Firebase Configuration and Initialization
    const firebaseConfig = {
      apiKey: "AIzaSyAvuEg4cz87jLaZFp0jkVdkVCCnpU_L3MM",
      authDomain: "catchstar-mining-game.firebaseapp.com",
      projectId: "catchstar-mining-game",
      storageBucket: "catchstar-mining-game.appspot.com",
      messagingSenderId: "585571833493",
      appId: "1:585571833493:web:1751bf232d73ac7a0bed9c",
      measurementId: "G-BJY2B999R7"
    };

    // Initialize Firebase
    const app = firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    document.addEventListener("DOMContentLoaded", () => {
      // Total Coins Functionality
      function fetchTotalCoins() {
        const userId = "your-user-id"; // Replace with your dynamic user ID logic
        db.collection('users').doc(userId).get().then((doc) => {
          if (doc.exists) {
            const totalCoins = doc.data().coins;
            document.getElementById('totalCoins').textContent = totalCoins;
          } else {
            console.log("No such document!");
          }
        }).catch((error) => {
          console.log("Error getting document:", error);
        });
      }

      // Initial call to fetch total coins
      fetchTotalCoins();

      // Daily Check-in Functionality
      const checkInBtn = document.getElementById("checkInBtn");
      const checkInMessage = document.getElementById("checkInMessage");

      let checkedIn = localStorage.getItem('checkedIn') === 'true';

      const updateCheckInStatus = () => {
        if (checkedIn) {
          checkInMessage.textContent = "You have already checked in today.";
          checkInBtn.disabled = true;
        } else {
          checkInMessage.textContent = "";
          checkInBtn.disabled = false;
        }
      };

      updateCheckInStatus();

      checkInBtn.addEventListener("click", () => {
        if (!checkedIn) {
          checkedIn = true;
          localStorage.setItem('checkedIn', 'true');
          checkInMessage.textContent = "Check-in successful! You have earned 500 stars.";
          checkInBtn.disabled = true;

          setTimeout(() => {
            checkedIn = false;
            localStorage.setItem('checkedIn', 'false');
            updateCheckInStatus();
          }, 24 * 60 * 60 * 1000);
        }
      });

      // Referral Program and Social Task Functionality here...
    });
  </script>
</body>
</html>
